{"version":3,"sources":["node_modules/@ctrip/crnweb/src/react-native/components/Navigator/Navigator.web.js"],"names":["isSupportLocalStrage","global","cw_api_isPrivateMode","pushUbt","obj","__bfi","push","pageCallbackEventName","Navigator","props","routeStack","_webRouteStack","console","log","routeHistoryStack","routeHistoryArr","pagePastInstance","Error","popOptionObj","_routerMaps","routes","pageInstance","parentNode","document","getElementById","inNode","outNode","state","presentedIndex","popRouteName","DeviceEventEmitter","subscribe","pageName","info","pop","_pop","bind","removeEventListener","addEventListener","e","currentApp","globalTouchMove","moveFlag","moveTarget","target","loadView","route","location","pathname","indexOf","aliasName","method","url","html","isLandingPage","queryStringObj","queryString","_transformToQueryString","history","pushState","text","options","title","replaceState","elem","cls","replace","length","RegExp","test","className","_hasClass","newClass","testStyle","hasOwnProperty","style","display","pageid","getPageId","startTime","navigationStart","endTime","Date","getTime","prjName","WEBPACK_PROJECT_NAME","crnwebVer","WEBPACK_CRNWEB_VERSION","cwVer","WEBPACK_CW_VERSION","name","value","tag","callback","afterAnimateRun","createElement","animationNameArr","animateHandler","i","_removeClass","_showView","_record","_addClass","setTimeout","router","self","comInstance","renderScene","call","urlTitle","renderUrlTitle","header","React","cloneElement","navigationBar","passProps","temptitle","getID","curPageid","Scene","sceneRef","buPageIns","store","context","params","_registryFunction","args","_registryData","comPage","ref","Object","keys","app","urlQuery","flex","width","height","setState","ReactDOM","findDOMNode","preventDefault","Component","childContextTypes","renderNode","mergeUrl","setAttribute","appendChild","pageDidDisappear","render","changeHistory","_onDidShow","isRefreshLoad","href","node","sceneConfig","localStorage","setItem","JSON","stringify","searchString","search","ex","animateClass","gestures","animate","switchView","isPopPage","matchRouter","error","routeParamsString","getItem","routeObj","parse","component","toString","comp","renderCallBack","__lazyRequireFlag","load","urlPattern","prop","_getRouterFromName","index","cb","routerStack","getCurrentRoutes","routerCount","slice","replaceAtIndex","cw_routeMapConfig","_getRouteName","trim","back","Platform","isInApp","CtripUtil","app_back_to_last_page","_removeNodeAndUnmount","popItem","isExists","rIndex","componentWillUnmount","lastRouteView","_setQueryString","pageTitle","__updateList","willLostPageInstance","pageDidAppear","_trigger","unmountComponentAtNode","remove","removeChild","codeString","decodeURIComponent","json","map","key","encodeURIComponent","join","urlParams","match","matchStringArr","substring","exec","_decode","keyArr","keyIndex","onDidFocus","id","defaultProps","configureScene","__currentRouter","contextTypes","NavigationBar","leftButton","rightButton","navigation","navigator","routeMapper","LeftButton","pageContext","RightButton","userAgent","headerHeight","flexDirection","Title","SceneConfigs","PushFromRight","FloatFromRight","FloatFromLeft","FloatFromBottom","FloatFromBottomAndroid","FadeAndroid","HorizontalSwipeJump","HorizontalSwipeJumpFromRight","VerticalUpSwipeJump","VerticalDownSwipeJump"],"mappings":"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","file":"Navigator.web.js","sourceRoot":"/Users/jane/Documents/HaloAI","sourcesContent":["/**\n *\n * @providesModule Navigator\n */\n'use strict';\n\nimport React, {Component} from 'react';\n\nimport ReactDOM from 'react-dom';\n// import PropTypes from 'prop-types';\nimport View from  './../View/View.web';\nimport Platform from  './../../apis/Platform/Platform.web.js';\nimport DeviceEventEmitter from './../../apis/EventEmitter/DeviceEventEmitter.web';\n\nlet isSupportLocalStrage=!global.cw_api_isPrivateMode;\nlet pushUbt = (obj)=>{\n    if(!global.__bfi){\n        global.__bfi = [];\n    }\n    global.__bfi.push(obj);\n};\nconst pageCallbackEventName='pagecallback';\n\nclass Navigator extends Component {\n\n    constructor(props) {\n        super(props);\n\n        let routeStack = this.props._webRouteStack;\n        console.log('routeStack', routeStack);\n\n        this.routeHistoryStack=[];\n        this.routeHistoryArr=[];\n        // this.reduxListensArr=[];\n        this.pagePastInstance=null;\n        if(!routeStack){\n            throw new Error('invalid routeStack or initialRoute');\n        }\n        this.popOptionObj={};\n\n        this._routerMaps=routeStack.routes;\n        this.pageInstance=null;\n        this.parentNode=document.getElementById(\"rootTag\")\n        this.inNode=null;\n        this.outNode =null;\n        this.state = {\n            presentedIndex: 0,\n        };\n        this.popRouteName=\"\";\n\n        DeviceEventEmitter.subscribe(\"popToPage\",function (pageName,info) {\n            this.pop(pageName,info);\n        },this);\n        this._pop=this._pop.bind(this);\n        if(global.document){\n            //åœ¨å°ç±³æ‰‹æœºæºç¨‹appä¸­èµ°å®Œconstructoråˆå§‹è·¯ç”±ï¼Œç«‹å³æ‰§è¡Œäº†ä¸€æ¬¡popstateï¼Œå¯¼è‡´self.isRefreshLoadä¸é€‚ç”¨ï¼Œå¯¼è‡´ç™½å±ï¼Œå³ä½¿åŠ å…¥å¯¹self.isRefreshLoadçš„åˆ¤æ–­ï¼ŒğŸˆ¶åˆå¯¼è‡´historyStackå¤§äº1æ— æ³•èµ°appçš„è¿”å›çš„é—®é¢˜\n            global.removeEventListener('popstate',this._pop);\n            global.addEventListener('popstate', this._pop);\n            //ä¿®å¤iosæµè§ˆå™¨ä¸­ä»å¤´éƒ¨å¼€å§‹ä¸‹æ‹‰æ—¶ä¸ä¼šè§¦å‘touchmoveäº‹ä»¶ï¼Œå¯¼è‡´pressäº‹ä»¶è¢«è§¦å‘çš„é—®é¢˜ã€‚\n            global.document.addEventListener(\"touchmove\",function(e){\n                global.currentApp.globalTouchMove={\n                    moveFlag:true,\n                    moveTarget:e.target\n                };\n                // e.preventDefault&&e.preventDefault();//æ³¨é‡Šæ‰æ­¤è¡Œæ˜¯å› ä¸ºä¸ä¼šè§¦å‘gruntäº‹ä»¶ã€‚\n            });\n        }\n\n        this.loadView(null,null,true);\n\n    };\n\n    static defaultProps = {\n        configureScene(){\n            return this.__currentRouter.component\n        }\n    };\n\n    static contextTypes={\n        store:null\n    };\n\n    static getID (){\n        let id= \"crnweb_viewport_\"+(new Date().getTime());\n        return id;\n    }\n\n\n    matchRouter(method){\n        let route= location.pathname;\n        if(route.indexOf(\"/\")!=0){\n            route =\"/\"+route;\n        }\n        return this._routerMaps[route]\n\n    }\n    mergeUrl(route){\n        if(route.aliasName){\n            return route.aliasName;\n        }else{\n            return route.pathname;\n        }\n    }\n    changeHistory(method,url,html,isLandingPage,queryStringObj){\n        if(!isLandingPage) {\n            if (method == \"push\") {\n                let queryString = this._transformToQueryString(queryStringObj);\n                if(queryString){\n                    url=url+\"?\"+queryString;\n                }\n                history.pushState({url: url, text: html, options: {pushState: true}}, document.title, url);\n            } else if (method == \"pop\") {\n                history.replaceState({url: url, text: html, options: {pushState: false}}, document.title, url);\n                //history.({url: url, text: html, options: {pushState: true}}, document.title, url);\n            }\n        }\n\n    }\n    _hasClass(elem, cls) {\n        cls = cls || '';\n        if (cls.replace(/\\s/g, '').length == 0) return false; //å½“clsæ²¡æœ‰å‚æ•°æ—¶ï¼Œè¿”å›false\n        return new RegExp(' ' + cls + ' ').test(' ' + elem.className + ' ');\n    }\n\n    _addClass(elem, cls) {\n        if (!this._hasClass(elem, cls)) {\n            elem.className = elem.className == '' ? cls : elem.className + ' ' + cls;\n        }\n    }\n\n    _removeClass(elem, cls) {\n        if (this._hasClass(elem, cls)) {\n            let newClass = ' ' + elem.className.replace(/[\\t\\r\\n]/g, '') + ' ';\n            while (newClass.indexOf(' ' + cls + ' ') >= 0) {\n                newClass = newClass.replace(' ' + cls + ' ', ' ');\n            }\n            elem.className = newClass.replace(/^\\s+|\\s+$/g, '');\n        }\n    }\n    _showView(inNode,testStyle){\n        if(!inNode){\n            throw new Error('navigator.inNode is not exist!');\n        }\n        if(testStyle.hasOwnProperty(\"flex\")){\n            inNode.style.display=\"flex\";\n        }else if(testStyle.hasOwnProperty(\"webkitFlex\")){\n            inNode.style.display=\"-webkit-flex\";\n        }else if(testStyle.hasOwnProperty(\"webkitBoxFlex\")){\n            inNode.style.display=\"-webkit-box\";\n        }\n    }\n    _record(){\n        let pageid=0;\n        if(currentApp&&currentApp.pageInstance&&currentApp.pageInstance.getPageId){\n            pageid=currentApp.pageInstance.getPageId();\n        }\n        try{\n            let startTime=this.navigationStart||0,endTime=(new Date).getTime();\n            let diffTime = endTime - startTime;\n            let options={prjName: WEBPACK_PROJECT_NAME, crnwebVer:WEBPACK_CRNWEB_VERSION,cwVer:WEBPACK_CW_VERSION,startTime:startTime,endTime:endTime};\n            options.pageid=pageid;\n\n            pushUbt(['_trackMetric', {\n                name: \"101534\",       //{string} metric name éœ€è¦ç”³è¯·\n                value: diffTime,       //{number} metric value åªèƒ½æ˜¯æ•°å­—\n                tag: options       //å¯é€‰é…ç½®,{object} Metric Tagï¼ŒTagçš„Keyåªèƒ½æ˜¯å­—ç¬¦ä¸²,tagçš„å€¼é•¿åº¦ä¸èƒ½è¶…è¿‡200ï¼Œæ•°é‡ä¸èƒ½è¶…è¿‡8ä¸ª\n            }]);\n            // console.log('101534',diffTime,options);\n        }catch(e){\n            console.log('[pageJump]-error',e);\n        }\n    }\n    switchView(inNode,outNode,className,callback){\n        let afterAnimateRun = false;\n        let testStyle = document.createElement('div').style;\n        let animationNameArr =[\"animationend\",\"webkitAnimationEnd\"];\n\n        if(className){\n\n            let animateHandler = () => {\n                if (afterAnimateRun) {\n                    return;\n                }\n                afterAnimateRun = true;\n                for(let i=0;i<animationNameArr.length;i++){\n                    inNode.removeEventListener( animationNameArr[i],()=>{});\n                }\n                this._removeClass(inNode,'animatestart');\n                this._removeClass(className);\n\n                if(outNode){\n                    outNode.style.display=\"none\";\n                }\n                callback&&callback()\n            }\n\n            for(let i=0;i<animationNameArr.length;i++){\n                inNode.addEventListener( animationNameArr[i], animateHandler);\n            }\n            this._showView(inNode,testStyle);\n            this._record();\n            this._addClass(inNode,'animatestart');\n            this._addClass(inNode,className);\n            setTimeout(animateHandler,1000);\n        }else{\n            if(outNode){\n                outNode.style.display=\"none\";\n            }\n            this._showView(inNode,testStyle);\n            this._record();\n            callback&&callback()\n        }\n    }\n\n    renderCallBack(router,method,isLandingPage){\n        let self =this;\n        let comInstance = self.props.renderScene.call(self, router, self);\n\n        let urlTitle = self.props.renderUrlTitle && self.props.renderUrlTitle();\n        let header = React.cloneElement(self.props.navigationBar, {passProps: router, urlTitle: urlTitle});\n        let temptitle = router.title;\n\n        let pageid = Navigator.getID();\n        currentApp.curPageid = pageid;\n\n        //if(routeHistory)\n        class Scene extends Component{\n            constructor(props){\n                super(props);\n                if (router.title) {\n                    if(global.document){\n                        global.document.title = router.title;\n                    }\n                }\n                this.sceneRef = null;\n                this.buPageIns =null;\n                this.state={\n                    header: header\n                }\n            }\n            static childContextTypes={store:null}\n            getChildContext() {\n                return { store: self.context&&self.context.store };\n            }\n            render(){\n                let callback=null;\n                if(router.params&&router.params.callback){\n\n                    DeviceEventEmitter._registryFunction(pageCallbackEventName,router.params.callback,currentApp.pageInstance);\n                    callback=function (...args) {\n                        DeviceEventEmitter._registryData(pageCallbackEventName,...args);\n                    }\n                }\n                let comPage = React.cloneElement(comInstance,{...router.params,\n                    passProps: router.params||self.props.params,\n                    callback, ref:(ref)=>{this.buPageIns=ref}});\n                if (router.queryStringObj&&Object.keys(router.queryStringObj).length > 0) {\n                    comPage.props.app.urlQuery = router.queryStringObj;\n                }\n                return (\n                    <View name=\"Scene\" style={{flex: 1, display: 'flex',width:'100%',height:'100%'}} ref={(ref)=>{this.sceneRef=ref}}>\n                        {this.state.header}\n                        {comPage}\n                    </View>\n                )\n            }\n            componentWillUnmount(){\n                //tp('Scene componentWillUnMount');\n            }\n            componentDidMount(){\n\n                if (temptitle != router.title) {\n                    if(global.document){\n                        global.document.title = router.title||urlTitle||'';\n                    }\n\n                    let header = React.cloneElement(self.props.navigationBar, {\n                        passProps: router,\n                        urlTitle: urlTitle\n                    });\n                    this.setState({\n                        header: header\n                    });\n                }\n\t            //æŸäº›æµè§ˆå™¨(å¦‚IOS Safariã€å¾®ä¿¡æµè§ˆå™¨ï¼Œå‚è§ Issue #384ã€#409 )ä¸Šçš„é¡µé¢æ»‘åŠ¨æ—¶ä¼šè§¦å‘æµè§ˆå™¨é»˜è®¤çš„æ»‘åŠ¨è¡Œä¸ºã€‚\n                //å¯¹æ•´ä¸ªdocumentä½¿ç”¨preventDefaultå¯¹å¾®ä¿¡æµè§ˆå™¨ä¸èµ·ä½œç”¨ï¼Œè§issue #409ã€‚\n\t            ReactDOM.findDOMNode(this.sceneRef).addEventListener('touchmove',(e)=>{\n\t\t            e.preventDefault && e.preventDefault();\n\t            }, false);\n            }\n        }\n\n\n\n        let renderNode = document.createElement(\"div\");\n        let url = this.mergeUrl(router);\n        renderNode.setAttribute(\"id\", pageid);\n        renderNode.style.display = 'none';\n        renderNode.style.height = '100%';\n        renderNode.style.width = '100%';\n        renderNode.style.flex = '1 1 0%';\n        renderNode.setAttribute(\"page-url\", url);\n        this.parentNode.appendChild(renderNode);\n\n\n        this.outNode=this.inNode;\n        this.inNode=document.getElementById(pageid);\n        this.pagePastInstance = this.pageInstance;\n        //fix:ä¸CRNç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´ï¼ŒAé¡µé¢pushåˆ°Bé¡µé¢æ—¶ï¼ŒAè¿˜åœ¨ï¼Œæ•…ä¸æ‰§è¡ŒAçš„componentWillUnmountï¼›\n        //å‡ºé”™åœºæ™¯ï¼šé…’åº—çš„hotelnbé¡¹ç›®ï¼Œpushæ—¶æ‰§è¡Œäº†componentWillUnmountï¼Œé€ æˆHomeé¡µä¸­reduxå¯¹storeçš„ç›‘å¬å™¨ä¸¢å¤±ï¼Œ\n        // cityé¡µæ›´æ–°storeåï¼Œreduxæ— æ³•è§¦å‘Homeé¡µé‡æ–°render.\n        // if( this.pagePastInstance&&currentApp.pageInstance&&currentApp.pageInstance.componentWillUnmount){\n        //     currentApp.pageInstance.componentWillUnmount();\n        // }\n        if( this.pagePastInstance&&currentApp.pageInstance&&currentApp.pageInstance.pageDidDisappear){\n            currentApp.pageInstance.pageDidDisappear();\n        }\n        // éœ€è¦å…ˆæ¸²æŸ“é¡µé¢ï¼Œå†changeHistoryï¼Œä¿è¯é¡µé¢åˆ‡æ¢çš„æ­£ç¡®æ€§\n\n        this.pageInstance = ReactDOM.render(React.createElement(Scene),this.inNode);\n\n        this.changeHistory(method,url, \"\",isLandingPage,router.queryStringObj);\n        if(method=='pop'){//fix:æ‰§è¡ŒPageçš„replaceæ–¹æ³•æ—¶åº”å°†è·¯ç”±å†å²å †æ ˆæ ˆé¡¶è®°å½•å¼¹å‡ºã€‚\n            (this.routeHistoryStack.length>0) && this.routeHistoryStack.pop();\n        }\n        currentApp.pageInstance=this.pageInstance&&this.pageInstance.buPageIns||{};\n        //fixï¼š(Issue #396)Page _onDidShowåŸ‹ç‚¹ä¸­urlæœªåˆ‡æ¢é—®é¢˜ã€‚\n\t    currentApp.pageInstance._onDidShow&&currentApp.pageInstance._onDidShow(router);\n\n        if(this.isRefreshLoad){//å¤„ç†åˆ·æ–°é¡µé¢æ—¶å€™çš„è·¯ç”±ï¼Œç›´æ¥èµ°æµè§ˆå™¨çš„å‰è¿›åé€€ï¼Œåˆ·æ–°ä¸€æ¬¡ï¼Œç›¸å¯¹äºé‡æ–°å»ºç«™ä¸€æ¬¡\n        }else{\n            this.routeHistoryStack.push({ pageName:router.name, pageid: pageid, pageInstance: this.pageInstance,url:location.href,node:this.inNode,sceneConfig:router.sceneConfig});\n            // this.routeHistoryArr.push({pageName:router.name,pageid: pageid, pageInstance: this.pageInstance,url:location.href,node:this.inNode,sceneConfig:router.sceneConfig});\n        }\n        this.routeHistoryArr.push({pageName:router.name,pageid: pageid, pageInstance: this.pageInstance,url:location.href,node:this.inNode,sceneConfig:router.sceneConfig});\n        if(router.params){\n            if(isSupportLocalStrage){\n                try{\n                    global.localStorage.setItem(router.name+\"_cache\", JSON.stringify(Object.assign({},router.params,{searchString:location.search}) ))\n                }catch(ex){\n                    console.log('router å‚æ•°å†™å…¥localStorageå¤±è´¥',ex);\n                }\n            }\n        }\n        // renderNode.style.display = 'flex';\n        let animateClass=\"\";\n        if(router.sceneConfig&&router.sceneConfig.gestures){\n            animateClass =router.sceneConfig.gestures.animate;\n        }\n\n        this.switchView(this.inNode,this.outNode,animateClass);\n    }\n    loadView(router,method,isLandingPage){\n        this.navigationStart=new Date().getTime();\n        if(!router){\n            router={}\n        }\n        currentApp.isPopPage=false;\n\n\n        if(Object.keys(router).length==0) {\n            router = this.matchRouter();\n            if(!router){\n                console.error(\"No Route Found\");\n                return;\n            }\n        }\n\n        //landingPage\n        if(!method){\n            if(isSupportLocalStrage){\n                try{\n                    let routeParamsString =  global.localStorage.getItem(router.name+\"_cache\");\n                    let routeObj = JSON.parse(routeParamsString);\n                    if(routeObj&&(routeObj.searchString!=\"\")){\n                        if(routeObj.searchString==location.search){\n                            router.params = Object.assign(router.params||{},routeObj);\n                        }\n                    }\n                }catch(e){\n                    console.log('router å‚æ•°è¯»å–localStorageå¤±è´¥',e);\n                }\n            }\n\n            method=\"push\";\n        }\n        // else{\n        //     this.setCurrentListeners();\n        // }\n\n\n        let self = this;\n        if (router.component && router.component.toString().indexOf(\"__CRNWEBFUNCTION__\") >= 0){\n            router.component(function (comp) {\n                router.component=comp;\n                self.renderCallBack(router,method,isLandingPage);\n            })\n        }else{\n            if(!router.component){\n                console.log(\"router.component ä¸å­˜åœ¨ï¼Œé¡µé¢å°†ä¼šæŠ¥é”™ï¼ï¼ï¼ï¼Œè¯·æ£€æŸ¥routeré…ç½®...\",router);\n            }\n            if(router.component.__lazyRequireFlag&&router.component.load){\n                router.component=router.component.load();\n                self.renderCallBack(router,method,isLandingPage);\n            }else{\n                this.renderCallBack(router,method,isLandingPage);\n            }\n        }\n\n\n    }\n\n    render() {\n        // var InitComponent= this.props.initialRoute.component;\n        return (\n            <View></View>\n        );\n\n    }\n\n\n    _generateRealURL(urlPattern, passProps) {\n        // let realUrl = '';\n        if (passProps) {\n            for (let prop in passProps) {\n                urlPattern = urlPattern.replace(new RegExp(':' + prop, 'ig'), passProps[prop]);\n            }\n        }\n        return urlPattern\n    }\n\n    /**\n     * @param {Router}\n     * 1ã€nav.push(routerobject)\n     */\n    push(router) {\n\n        console.log(router);\n\n        this.loadView(router,\"push\")\n\n    }\n    // setCurrentListeners(){\n    //     if(global.crnRedux&&global.crnRedux.nextListeners&&global.crnRedux.nextListeners.length>0) {\n    //         this.reduxListensArr.push(Object.assign([],global.crnRedux.nextListeners));\n    //     }\n    // }\n    replace(pageName,params) {\n        //Replace the current scene with a new route\n        // this.pageWillDisappear && this.pageWillDisappear();\n        let router=this._getRouterFromName(pageName);\n        if(params){\n            router.params = Object.assign({},params);\n        }\n        this.loadView(router,'pop');\n        // this.pageDidDisappear && this.pageDidDisappear();\n    }\n\n    replaceAtIndex(pageName,index,cb,params) {\n        //  Replace a scene as specified by an index\n        let routerStack=this.getCurrentRoutes(),routerCount=routerStack.length;\n\n        if(index<routerCount){\n            routerStack=this.routeHistoryStack.slice(0,index);\n            this.routeHistoryStack=routerStack;\n            this.replace(pageName,params);\n            cb&&cb();\n        }\n    }\n\n    replacePrevious(pageName,params) {\n        //Replace the previous scene\n        let routerStack=this.getCurrentRoutes(),routerCount=routerStack.length;\n        this.replaceAtIndex(pageName,routerCount-2,null,params);\n    }\n\n    _getRouteName(pageName){\n        if(!pageName){return ''}\n        if (global.cw_routeMapConfig) {\n            if (global.cw_routeMapConfig[pageName]) {\n                pageName = global.cw_routeMapConfig[pageName];\n            }\n        }\n        return pageName;\n    }\n    _getRouterFromName(pageName){\n        let route=this._getRouteName(pageName);\n        if(route){\n            if(route.trim().indexOf(\"/\")!=0){\n                route=\"/\"+route;\n            }\n            let router=this._routerMaps[route]||{};\n            return router;\n        }else{\n            throw new Error('invalid pageName,pageName does not in routeStack');\n        }\n\n    }\n\n    getCurrentRoutes() {\n        if(this.routeHistoryStack){\n            return this.routeHistoryStack;\n        }\n    }\n\n    jumpBack() {\n        //- Jump backward without unmounting the current scene\n    }\n\n    jumpTo() {\n        //Transition to an existing scene without unmounting\n    }\n\n    resetTo(router) {\n        // Navigate to a new scene and reset route stack\n    }\n\n    immediatelyResetRouteStack(routeStack) {\n        // Reset every scene with an array of routes\n    }\n\n    popToRoute(router) {\n        //æš‚æ—¶ç¦ç”¨--æ²¡æœ‰å®ç°\n        //Pop to a particular scene, as specified by its router. All scenes after it will be unmounted\n        // let routes=this.getCurrentRoutes();\n        // let targetIndex,target=routes.filter((page,index) => { let flag= page.name===router.name;if(flag){targetIndex=index;}return flag;})[0];\n        // if(typeof targetIndex ==\"number\"){\n        //     this.__routerObj.go(targetIndex-routes.length+1);\n        // }else{\n        //     console.log('è¿™ä¸ªrouteè¿˜æ²¡æœ‰è¢«æ³¨å†Œåˆ°pageså½“ä¸­ï¼Œæ— æ³•ä½¿ç”¨ã€‚',router);\n        // }\n\n    }\n\n    popToTop() {\n\n        history.back();\n    }\n\n    pop(pageName,options) {\n\n        // let presentedIndex = this.state.presentedIndex;\n        // if (presentedIndex) {\n        //     this.setState({'presentedIndex': (presentedIndex - 1)})\n        // } else {\n        //     this.setState({'presentedIndex': 0})\n        // }\n        //this.__routerObj.goBack();\n\n\n        //this.loadView(null,\"pop\")\n        if(options){\n            this.popOptionObj=options;\n        }else{\n            this.popOptionObj={};\n        }\n\n        if((Platform.isInApp)&&(this.routeHistoryStack.length ==1) ) {\n            global.CtripUtil&&CtripUtil.app_back_to_last_page();\n        }else {\n            if (pageName) {\n                if (global.cw_routeMapConfig) {\n                    if (global.cw_routeMapConfig[pageName]) {\n                        pageName = global.cw_routeMapConfig[pageName];\n                    }\n                }\n                this.popRouteName = pageName;\n            } else {\n                this.popRouteName = \"\";\n            }\n\n            if (this.popRouteName) {\n                this._pop();\n            } else {\n                history.back();\n            }\n        }\n    }\n\n    _pop(){\n        //IOSä¸‹çš„å¾®ä¿¡ï¼Œ é¦–é¡µè¿›å»ï¼Œè¿”å›ä¼šè§¦å‘popstateè¿™é‡Œå±è”½è¿™ä¸ªå¤šä½™çš„å¤„ç†\n        let self=this;\n        if (self.routeHistoryStack.length<2) {\n            if(self.popRouteName){\n                if(self.popRouteName.trim().indexOf(\"/\")!=0){\n                    self.popRouteName=\"/\"+self.popRouteName;\n                }\n                if(self._routerMaps[self.popRouteName]) {\n                    self._removeNodeAndUnmount(currentApp.curPageid);\n                    self.isRefreshLoad=true;\n                    self.loadView(self._routerMaps[self.popRouteName], \"pop\");\n                    self.isRefreshLoad=false;\n                }\n                self.popRouteName='';\n                return true;\n            }else{\n\n                var router=self._routerMaps[location.pathname];\n                if(router){//&&self.routeHistoryArr.length<2\n                    self._removeNodeAndUnmount(currentApp.curPageid);\n                    self.isRefreshLoad=true;\n                    self.loadView(router, \"pop\");\n                    self.isRefreshLoad=false;\n                }\n                return true;\n            }\n\n            // if(self.popRouteName){\n            //     if(self.popRouteName.trim().indexOf(\"/\")!=0){\n            //         self.popRouteName=\"/\"+self.popRouteName\n            //     }\n            //     if(self._routerMaps[self.popRouteName]) {\n            //         self.loadView(self._routerMaps[self.popRouteName], \"pop\");\n            //     }\n            // }else{\n            //     return true;\n            // }\n        }else {\n            if(!global.document){\n                return;//todo\n            }\n            let popItem = null;\n            // let reduxPopIndex=0;\n            if (self.popRouteName) {\n                let isExists = false;\n                for (let rIndex = self.routeHistoryStack.length - 2; rIndex >= 0; rIndex--) {\n                    // popItem = self.routeHistoryStack.pop();\n                    // reduxPopIndex+=1;\n                    // if (self.routeHistoryStack[rIndex].pageName == self.popRouteName) {\n                    //     isExists = true;\n                    //     break;\n                    // }\n\n                    popItem = self.routeHistoryStack.pop();\n                    var pageName=self.routeHistoryStack[rIndex].pageName;\n                    if ( pageName== self.popRouteName||('/'+pageName)==self.popRouteName) {\n                        isExists = true;\n                        break;\n                    }else if(popItem){\n                        self._removeNodeAndUnmount(popItem.pageid);\n                    }\n                }\n                if (!isExists) {\n                    console.log(\"The router is not found in history!\");\n                    //throw new Error(\"The router is not found in history:\",self.popRouteName);\n                    popItem=self.routeHistoryArr.pop();\n                    self.routeHistoryStack=[...self.routeHistoryArr];\n                    // return;\n                }\n            } else {\n                popItem = self.routeHistoryStack.pop();\n                // reduxPopIndex=1;\n            }\n            if (popItem && currentApp&& currentApp.pageInstance && currentApp.pageInstance.componentWillUnmount) {\n                currentApp.pageInstance.componentWillUnmount();\n            }\n            let lastRouteView = self.routeHistoryStack[self.routeHistoryStack.length - 1];\n            self.outNode = self.inNode;\n            self.inNode = global.document.getElementById(lastRouteView.pageid);\n            if(self.popOptionObj.queryStringObj&&Object.keys(self.popOptionObj.queryStringObj).length>0){\n                lastRouteView.url = self._setQueryString(self.popOptionObj.queryStringObj,lastRouteView.url)\n            }\n\n            let pageTitle = self._routerMaps[lastRouteView.pageName].title;\n            global.history.replaceState({\n                url: lastRouteView.url,\n                text: \"\",\n                options: \"\"\n            }, pageTitle, lastRouteView.url);\n            global.document.title = pageTitle || document.title;\n            let animateClass=null;\n            if(lastRouteView.sceneConfig&&lastRouteView.sceneConfig.gestures){\n                animateClass=lastRouteView.sceneConfig.gestures.animate;\n            }\n\n            React.__updateList = [];\n            // ReactDOM.unmountComponentAtNode(self.outNode)\n            // if(global.crnRedux&&global.crnRedux.nextListeners&&global.crnRedux.nextListeners.length>0){\n            //     let popReduxItem=[];\n            //     for(let popIndex=0;popIndex<reduxPopIndex;popIndex++){\n            //         if( self.reduxListensArr.length>0){\n            //             popReduxItem = self.reduxListensArr.pop();\n            //         }\n            //     }\n            //     global.crnRedux.nextListeners=popReduxItem;\n            // }\n            currentApp.isPopPage=true;\n            self.switchView(self.inNode, self.outNode, animateClass, function () {\n                //å…¼å®¹æŸäº›æµè§ˆå™¨ï¼ˆå¦‚ Safari Mobileï¼‰ä¸æ”¯æŒremoveæ–¹æ³•ã€‚\n                // let outnode = self.outNode;\n                // if(outnode){\n                //     if(outnode.remove){\n                //         outnode.remove();\n                //     }\n                //     else if(outnode.parentNode !== null){\n                //         outnode.parentNode.removeChild(outnode);\n                //     }\n                // }\n\n                self._removeNodeAndUnmount(self.outNode);\n                let willLostPageInstance=currentApp.pageInstance;\n                //change to next page\n                if(lastRouteView.pageInstance&&lastRouteView.pageInstance.buPageIns){\n                    currentApp.pageInstance=lastRouteView.pageInstance.buPageIns;\n                }else{\n                    currentApp.pageInstance={};\n                    console.log(\"currentApp.pageInstance is null,please checkout your logic\");\n                }\n                if(currentApp.pageInstance.pageDidAppear){\n                    currentApp.pageInstance.pageDidAppear(null,true);\n                }\n\n                if(willLostPageInstance.props&&\"function\"===typeof willLostPageInstance.props.callback){\n                    DeviceEventEmitter._trigger(pageCallbackEventName);\n                }\n                willLostPageInstance=null;\n                self.popRouteName='';\n            });\n\n        }\n    }\n\n    _removeNodeAndUnmount(node){\n        if('string'===typeof node){\n            node=document.getElementById(node);\n        }\n        if(node){\n            ReactDOM.unmountComponentAtNode(node);\n            if(node.remove){\n                node.remove();\n            }else if(node.parentNode !== null){\n                // self.outNode && self.outNode.remove();\n                //å…¼å®¹æŸäº›æµè§ˆå™¨ï¼ˆå¦‚ Safari Mobileï¼‰ä¸æ”¯æŒremoveæ–¹æ³•ã€‚\n                node.parentNode.removeChild(node);\n            }\n        }\n    }\n\n    _decode (codeString) { return decodeURIComponent(codeString.replace(/\\+/g, \" \")); };\n\n    _transformToQueryString(json) {\n        if(Object.keys(json).length>0){\n            return \"\"+Object.keys(json).map(function(key) {\n                    return encodeURIComponent(key) + '=' +\n                        encodeURIComponent(json[key]);\n                }).join('&');\n        }else{\n            return '';\n        }\n    }\n\n    _setQueryString(queryStringObj, url) {\n        let urlParams={},match, search = /([^&=]+)=?([^&]*)/g;\n        let matchStringArr=url.match(/(\\?.*)/);\n        let searchString =\"\";\n        if(matchStringArr&&matchStringArr.length>1){\n            searchString = matchStringArr[1].substring(1);\n            if(searchString){\n                while (match =search.exec(searchString)){\n                    urlParams[this._decode(match[1])] =match[2];\n                }\n            }\n        }\n\n        let keyArr = Object.keys(queryStringObj);\n        if(keyArr.length>0){\n            for(let keyIndex=0;keyIndex<keyArr.length;keyIndex++){\n                let name = keyArr[keyIndex];\n                name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n                urlParams[name]=queryStringObj[name];\n            }\n        }\n        if(searchString){\n            url = url.replace(searchString,this._transformToQueryString(urlParams));\n        }else{\n            url=url+\"?\"+this._transformToQueryString(urlParams);\n        }\n\n        return url;\n    }\n\n    didShow() {\n        let router = this.router;\n        if (router) {\n            this.props && this.props.onDidFocus && this.props.onDidFocus(router);\n        }\n    }\n\n    componentDidMount() {\n        // let routerObj = this.refs[this.__routerObjName];\n        // if (routerObj) {\n        //     this.__routerObj = routerObj.router;\n        // }\n        // let routerObj = this.refs[this.__routerObjName].router;\n        // if(routerObj){\n        //     this.__routerObj = routerObj;\n        // }\n        // let router = this.router;\n        // if(router){\n        //     this.props && this.props.onDidFocus && this.props.onDidFocus(router);\n        // }\n    }\n}\n\nclass NavigationBar extends Component {\n    constructor() {\n        super();\n    }\n\n    render() {\n        let leftButton = null, rightButton = null;\n        if (currentApp.navigation.navigator) {\n            //leftButton =currentApp.navigation.navigator&& currentApp.navigation.navigator.state.presentedIndex==0?null:this.props.routeMapper.LeftButton({pageContext:{}});\n            if (Platform.isInApp) {\n                leftButton = this.props.routeMapper.LeftButton({pageContext: {}});\n            } else {\n                if (global && global.history) {\n                    if (global.history.length <= 1) {\n                        leftButton = null;\n                    } else {\n                        leftButton = this.props.routeMapper.LeftButton({pageContext: {}});\n                    }\n                } else {\n                    leftButton = null;\n                }\n            }\n\n            if (this.props.passProps && this.props.passProps.pageContext) {\n                rightButton = this.props.routeMapper.RightButton(this.props.passProps);\n            }\n\n        }\n\n        if (global.navigator && global.navigator.userAgent.match(/(iPhone\\sOS)\\s([\\d_]+)/) && (Platform.isInApp)) {\n            // iphoneXé€‚é…\n            let headerHeight = global.navigator.userAgent.indexOf(\"iPhoneX\") > 0 ? (88-44):(64-44);\n            return (\n                <View>\n                    <View style={{flexDirection: 'row', ...this.props.style, height: headerHeight, width: '100%'}}>\n                    </View>\n                    <View style={{flexDirection: 'row', ...this.props.style, height: 44, width: '100%'}}>\n                        {leftButton}\n                        {this.props.routeMapper.Title({\n                            title: this.props.urlTitle || this.props.passProps.title,\n                            style: this.props.style\n                        })}\n                        {rightButton}\n                    </View>\n                </View>)\n        } else {\n\n            return (<View style={{flexDirection: 'row', ...this.props.style, height: 44, width: '100%'}}>\n                {leftButton}\n                {this.props.routeMapper.Title({\n                    title: this.props.urlTitle || this.props.passProps.title,\n                    style: this.props.style\n                })}\n                {rightButton}\n            </View>)\n        }\n    }\n}\n\nNavigator.NavigationBar = NavigationBar;\n\nclass SceneConfigs {\n    static PushFromRight = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"sliderightin\"}};\n    static FloatFromRight = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"sliderightin\"}};\n    static FloatFromLeft = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"slideleftin\"}};\n    static FloatFromBottom = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"slidedownin\"}};\n    static FloatFromBottomAndroid = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"slidedownin\"}};\n    static FadeAndroid = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"slidedownin\"}};\n    static HorizontalSwipeJump = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"slideleftin\"}};\n    static HorizontalSwipeJumpFromRight = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"sliderightin\"}};\n    static VerticalUpSwipeJump = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"slideupin\"}};\n    static VerticalDownSwipeJump = {\"gestures\": {\"jumpForward\": {}, \"jumpBack\": {},\"animate\":\"slidedownin\"}};\n}\n\nNavigator.SceneConfigs = SceneConfigs;\n\n\nexport default Navigator\n\n"]}