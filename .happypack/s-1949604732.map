{"version":3,"sources":["node_modules/@ctrip/crnweb/src/crn/lib/URL.js"],"names":["URL","url","callback","option","urlForTest","Platform","isInApp","openHybrid","test","location","origin","global","href","opt","CtripUtil","targetModel","app_open_url","title","pageName","indexOf","msg","console","log","Log","logTrace","e","message","info","segChar","options","openType","replace","setTimeout","open","Device","deviceType","openURL"],"mappings":"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","file":"URL.js","sourceRoot":"/Users/jane/Documents/HaloAI","sourcesContent":["/**\r\n * Created by bianyl on 2016/10/9.\r\n */\r\nimport {Platform} from 'react-native';\r\nimport isUrl from './Util/isUrl';\r\nimport Log from './Log';\r\nimport Device from './Device';\r\n\r\nexport default class URL {\r\n    /**\r\n     * 打开一个 URL，\r\n     * 支持 schema:\r\n     *\r\n     * HTTP(S)://\r\n     *\r\n     * ctrip://\r\n     *\r\n     * /\r\n     *\r\n     * 三种类型。\r\n     * 具体规范请参考 conf 文档：[http://conf.ctripcorp.com/pages/viewpage.action?pageId=57518232](http://conf.ctripcorp.com/pages/viewpage.action?pageId=57518232)\r\n     * @method openURL\r\n     * @param {String} url\r\n     * @param {Function} callback?\r\n     * @example\r\n     * ```\r\n     * URL.openURL(\"http://m.ctrip.com/webapp/forex/index?bid=1\");\r\n     * ```\r\n     */\r\n\r\n    static canOpenURL(url, callback) {\r\n        if (!isUrl(url)) {\r\n            callback(false);\r\n        } else {\r\n            callback(true);\r\n        }\r\n    }\r\n\r\n    static openURL(url, option) {\r\n\r\n        if (Platform.isInApp) {\r\n            URL.openHybrid(url, option);\r\n        } else {\r\n            var urlForTest = url;\r\n            if (!(/^http/).test(urlForTest)) {\r\n                urlForTest = location.origin + url;\r\n            }\r\n            if (!isUrl(urlForTest)) {\r\n                return;\r\n            }\r\n            global.location.href = url;\r\n        }\r\n    }\r\n\r\n    /*\r\n     @method openHybrid\r\n     @param {object} opt\r\n     @example\r\n\r\n     opt.targetModel:\r\n\r\n     0.HTTP地址＋当前页面；注： 该参数类似于js的location.href=\"\" <br/>\r\n\r\n     1.ctrip://协议地址;  注：只处理ctrip协议的URL Schema<br/>\r\n\r\n     2.HTTP地址＋新的WebView, title生效<br/>\r\n\r\n     3.HTTP地址＋第三方App URL Schema， 系统浏览器打开; 注：只支持online地址和其它App的URL Schema，例如微信的weixin://home<br/>\r\n\r\n     4.Hybrid相对地址＋新的WebView，title生效；<br/>\r\n\r\n     5.相对地址＋当前页面；注：5.8之前版本，内部自动调用app_cross_package_href<br/>\r\n\r\n     6.打开其他app；注：调用系统openurl <br/>\r\n\r\n     */\r\n    static openHybrid(url, opt = {}) {\r\n\r\n        try {\r\n            if (global.CtripUtil) {\r\n                if (opt.targetModel === 1 || /^ctrip:\\/\\//i.test(url)) {\r\n                    CtripUtil.app_open_url(url, 1, opt.title || '', opt.pageName || '');\r\n                } else if (opt.targetModel === 5 || url.indexOf('CRNType=1') > -1) {\r\n                    //CRN 页面使用5 CRNModuleName=xxxx&CRNType=1\r\n                    CtripUtil.app_open_url(url, 5, opt.title || '', opt.pageName || '');\r\n                } else if (opt.targetModel === 4 || /^\\//.test(url)) {\r\n                    //app里Hybrid相对路径跳转用4，必须以/开头，与crn保持一致\r\n                    CtripUtil.app_open_url(url, 4, opt.title || '', opt.pageName || '');\r\n                } else if (opt.targetModel === 0) {\r\n                    //http(s)页面 原来view打开页面\r\n                    CtripUtil.app_open_url(url, 0, opt.title || '', opt.pageName || '');\r\n                } else if (opt.targetModel === 2 || /^http(s)?:/i.test(url)) {\r\n                    //  新开view\r\n                    CtripUtil.app_open_url(url, 2, opt.title || '', opt.pageName || '');\r\n                } else {\r\n                    // opt.targetModel === 3\r\n                    CtripUtil.app_open_url(url, 3, opt.title || '', opt.pageName || '');\r\n                }\r\n            } else {\r\n                let msg='CtripUtil is not exist in hybrid or directConnect';\r\n                console.log(msg);\r\n                Log.logTrace(\"cw_msg_CtripUtil\",{msg:e.message,info:msg});\r\n            }\r\n        } catch (e) {\r\n            console.log(e);\r\n            Log.logTrace(\"cw_msg_openHybrid\",{msg:e.message});\r\n        }\r\n\r\n    }\r\n\r\n    static openURLWithTitle(url, title = '') {\r\n        var segChar = url.indexOf('?') > -1 ? \"&\" : '?';\r\n        if (title) {\r\n            url = url + segChar + 'crnWebTitle=' + title;\r\n        }\r\n        if (!isUrl(url)) {\r\n            return;\r\n        }\r\n        global.location.href = url;\r\n    }\r\n\r\n    /**\r\n     * 打开一个URL带回调函数\r\n     *\r\n     * @method openURLWithCallback\r\n     * @brief 打开一个URL带回调函数\r\n     * @param {*} url\r\n     * @param {*} callback\r\n     */\r\n    static openURLWithCallback(url, callback, options) {\r\n        if (!isUrl(url)) {\r\n            return;\r\n        }\r\n        // if (callback) {\r\n        //     url = url.indexOf('?') > -1 ? url + \"&\" : url + \"?\";\r\n        //     url = url + 'openurlwithcallback=' + callback.toString();\r\n        // }\r\n        if (options && options.openType && options.openType == 'replace') {\r\n            global.location.replace(url);\r\n        } else {\r\n            global.location.href = url;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 不建议使用\r\n     * @method openURLWithTitleAndCallback(Deprecated)\r\n     * @param {*} url\r\n     * @param {*} title\r\n     * @param {*} callback\r\n     */\r\n    static openURLWithTitleAndCallback(url, title = '', callback) {\r\n        var segChar = url.indexOf('?') > -1 ? \"&\" : '?';\r\n        if (title) {\r\n            url = url + segChar + 'crnWebTitle=' + title;\r\n        }\r\n        if (!isUrl(url)) {\r\n            return;\r\n        }\r\n        if (callback) {\r\n            setTimeout(function () {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            }, 3000);\r\n            global.open(url);\r\n        } else {\r\n            global.location.href = url;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 使用默认浏览器打开URL\r\n     * @param url 相应URL\r\n     */\r\n    static openURLWithDefaultBrowser(url) {\r\n        if (Platform.isInApp && Device.deviceType === 'android') {\r\n            if(CtripUtil && CtripUtil.app_open_url){\r\n                //传6.打开其他app；\r\n                CtripUtil.app_open_url(url, 6);\r\n            }\r\n        } else {\r\n            this.openURL(url);\r\n        }\r\n    }\r\n};"]}